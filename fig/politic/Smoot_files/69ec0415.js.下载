var FlagFeedback;(function(n){function k(n){n=n||window.event;var i=n.target||n.srcElement;t&&!t.contains(i)&&t.offsetHeight>0&&l()}function d(n){var i,r;n=n||window.event;i=n.target||n.srcElement;t&&t.contains(i)&&(r=n?n.which?n.which:n.keyCode:n.keyCode,r==rt?(i.tagName=="INPUT"||i.className=="buttonLink"||i.id=="fbdialogcl")&&i.click():r==ut?(i.className=="buttonLink"||i.id=="fbdialogcl")&&(i.click(),h(n)):r==ft&&(l(),h(n)))}function g(n){s&&!t.contains(n.target)&&(h(n),t.focus())}function h(n){sj_sp(n);sj_pd(n)}function c(){sj_ue(_d,"click",k);sj_ue(_d,"keydown",d);sj_ue(_d,"focusin",g);sj_evt.unbind("ajax.unload",c)}function et(){o=document.activeElement;var n=this.metadata;n&&ot(n.turl,n.maw,n.mah)}function ot(n,u,f){r.innerHTML="";var e=_d.createElement("img");e.src=n;u&&f&&(u>250?(e.width=250,e.height=f*250/u):(e.width=u,e.height=f));r.appendChild(e);t.style.display="block";s=!0;i.focus()}function st(){(i.checked||f.checked||e.checked)&&(u.style.display="none")}function l(){t.style.display="none";a.style.display="block";v.style.display="none";r.style.display="block";u.style.display="none";p.style.display="block";w.style.display="block";b.style.display="none";i.checked=!1;f.checked=!1;e.checked=!1;var n=this.metadata;n&&nt("flagClose",null,n.ns,n.k);s=!1;o&&o.focus();sj_evt.fire(it)}function ht(){var t,r,n,o;if(!i.checked&&!f.checked&&!e.checked){u.style.display="block";u.focus();return}if(t=[],i.checked&&t.push("irrelevant"),f.checked&&t.push("offensive"),e.checked&&t.push("adult"),r=t.join(","),n=this.metadata,n&&(nt("flagSubmit",r,n.ns,n.k),o=y.getAttribute("fbposturl"),o)){var s=window.location.href.match("(images|videos)"),c=s?s[0]:"",h=window.location.href.match(/q=(.+?)(&|$)/),l=h?h[1]:"",a=y.getAttribute("ss"),v=!!n.md5&&n.md5.length>0?n.md5:null;ReportResult.send(o,c,l,"External",encodeURIComponent(n.imgurl),encodeURIComponent(n.surl),encodeURIComponent(n.turl),v,null,r,n.src,a)}ct()}function nt(n,t,i,r){if(typeof mmLog!="undefined"&&mmLog){var u=['{"T":"CI.Click","Name":"',n,'","Meta":"',t,'","AppNS":"',i,'","K":"',r,".1",'","TS":',sb_gt(),"}"];mmLog(u.join(""))}}function ct(){a.style.display="none";v.style.display="block";r.style.display="none";p.style.display="none";w.style.display="none";b.style.display="block";tt.focus()}var t=_ge("fbdialog"),a=_ge("fbdialog_message"),v=_ge("fbthankyou_message"),y=_ge("fbdialog_container"),r=_ge("fbdialog_thumb_container"),u=_ge("fbdialog_errormessage"),p=_ge("checkbox_region"),i=_ge("irrelevant_mark_checkbox"),f=_ge("offensive_mark_checkbox"),e=_ge("adult_mark_checkbox"),w=_ge("fbdialog_buttons"),b=_ge("fbthankyou_button"),tt=_ge("adult_button_close"),it="flagfeedback_close",rt=13,ut=32,ft=27,o,s=!1;sj_be(_d,"click",k);sj_be(_d,"keydown",d);sj_be(_d,"focusin",g);sj_be(_d,"unload",c);sj_evt.bind("ajax.unload",c);n.c=et;n.p=st;n.s=ht;n.h=l})(FlagFeedback||(FlagFeedback={}))